<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>쉼;타로</title>
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
    <meta name="format-detection" content="telephone=no"> <!--숫자를 전화로 자동링크 방지-->
    
    <meta name="apple-mobile-web-app-capable" content="yes"> <!--애플기종의 상단 주소줄 감춤-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black">  <!--아이폰 주소창의 컬러값을 블랙으로 설정-->

    <link rel="stylesheet" href="style.css">

    <!--slick-->
    <link rel="stylesheet" type="text/css" href="slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="slick/slick.min.js"></script>
</head>

<body style="background-color: black; margin:0; text-align:center;">
    <div id = "medi-home" style="margin:8vw;">
        <p style="font-weight: bold; font-size: 4vw; margin:auto; color:white;">명상하기</p>
        <img src="img/meditate_main.png" style="width:66vw;">
        <div class="today-saying">
            <p style="font-weight:bold; font-size:3.5vw; text-align:left; color:white;">- 오늘의 명언 -</p>
            <p id="phrase"></p>
            <p id="from"></p>
        </div>

        <div class="left-align">
            <p style="font-size:4vw; font-weight:400; color:white; margin-top:3vh; margin-bottom:0;">이런 명상은 어때요?</p>
            <p style="color: #DCDCDC; font-size:3vw; margin:auto;">당신을 위해 준비한 오늘의 명상이에요 :)</p>
        </div>
    </div>
    
        <div id="medi-theme">
            <img src="img/medi/1.png" id="1" onclick="select_theme(id)" style="margin-right:2vw; width:26vw;">
            <img src="img/medi/2.png" id="2" onclick="select_theme(id)" style="margin-right:2vw; width:26vw;">
            <img src="img/medi/3.png" id="3" onclick="select_theme(id)" style="margin-right:2vw; width:26vw;">
            <img src="img/medi/4.png" id="4" onclick="select_theme(id)" style="margin-right:2vw; width:26vw;">
        </div>

        <img src ="img/icon/명상하기_선택전.png" id="medi-btn">

    <footer class="footer" style="text-align:left;">
        <img src='img/icon/icon_menu_diary.png' onclick="location.href='diary.html'" class="icon">
        <img src='img/icon/icon_menu_tag.png' onclick="location.href='keep.html'" class="icon">
        <img src='img/icon/icon_menu_main.png' onclick="location.href='home.html'" class="icon">
        <img src='img/icon/icon_menu_meditate_sel.png' onclick="location.href='meditation.html'" class="icon">
        <img src='img/icon/icon_menu_setting.png' onclick="location.href='setting.html'" class="icon">
    </footer>


    <!-- 테마별 명상 재생 페이지 -->

    <div id = "medi-1">
        <img src="img/icon/icon_back.png" style="float:left; width:2.5vw;" onclick="history.go(0)">
        <p style="font-weight: bold; font-size: 4vw; margin:auto; color:white;">명상하기</p>
        <a style="display:block; margin-top:10vh;">우울한 날을 위한 명상</a>
        <img src="img/medi/1_ing.png" style="width:79vw; margin-top:8vh;">
        <audio id="우울" src="music/music_test.mp3" onended="medi_end(true)"></audio>
        <div id="audioplayer">
            <div id="timeline"></div>
  		    <div id="playhead-1"></div>
        </div>
        <button id="btn-play-pause-1" class="music-btn"><i class="fa fa-play"></i></button>
    </div>

    <div id = "medi-2">
        <img src="img/icon/icon_back.png" style="float:left; width:2.5vw;" onclick="history.go(0)">
        <p style="font-weight: bold; font-size: 4vw; margin:auto; color:white;">명상하기</p>
        <a style="display:block; margin-top:10vh;">집중 안되는 날을 위한 명상</a>
        <img src="img/medi/2_ing.png" style="width:79vw; margin-top:8vh;">
        <audio id="집중" src="music/집중.mp3"></audio>
        <div id="audioplayer">
            <div id="timeline"></div>
  		    <div id="playhead-2"></div>
        </div>
        <button id="btn-play-pause-2" class="music-btn"><i class="fa fa-play"></i></button>
    </div>

    <div id = "medi-3">
        <img src="img/icon/icon_back.png" style="float:left; width:2.5vw;" onclick="history.go(0)">
        <p style="font-weight: bold; font-size: 4vw; margin:auto; color:white;">명상하기</p>
        <a style="display:block; margin-top:10vh;">푹 자고 싶은 날을 위한 명상</a>
        <img src="img/medi/3_ing.png" style="width:79vw; margin-top:8vh;">
        <audio id="푹잠" src="music/푹잠.mp3"></audio>
        <div id="audioplayer">
            <div id="timeline"></div>
  		    <div id="playhead-3"></div>
        </div>
        <button id="btn-play-pause-3" class="music-btn"><i class="fa fa-play"></i></button>
    </div>

    <div id = "medi-4">
        <img src="img/icon/icon_back.png" style="float:left; width:2.5vw;" onclick="history.go(0)">
        <p style="font-weight: bold; font-size: 4vw; margin:auto; color:white;">명상하기</p>
        <a style="display:block; margin-top:10vh;">명상하기</a>
        <img src="img/medi/4_ing.png" style="width:79vw; margin-top:8vh;">
        <audio id="명상" src="music/명상.mp3"></audio>
        <div id="audioplayer">
            <div id="timeline"></div>
  		    <div id="playhead-4"></div>
        </div>
        <button id="btn-play-pause-4" class="music-btn"><i class="fa fa-play"></i></button>
    </div>

    <!-- 명상완료 시 팝업 -->
    <div id="popup" class="hide">
        <div class="end_meditation">
            <img src="img/icon/icon_menu_main_sel.png" style="width: 9vw; margin:4vw;"><br>
            명상을 완료하였습니다<br>
            <img src="img/icon/완료버튼.png" onclick="history.go(0)" style="width:30vw; margin:4vw;">
        </div>
    </div>




<script type="text/javascript" src="slick/slick.min.js"></script>
<script>
/* 명언 랜덤 뽑기(자동) */
$.getJSON("saying.json", function(json){
    var index = Math.floor(json.saying.length * Math.random());
    document.getElementById("phrase").innerHTML = json.saying[index].phrase;
    if(json.saying[index].from==null) {
        document.getElementById("from").innerHTML = ''
    }
    else {document.getElementById("from").innerHTML = '- ' + json.saying[index].from + ' -';}
});

/* 명상 테마 고르기 */
$('#medi-theme').slick({
  infinite: true,
  slidesToShow: 3,
  slidesToScroll: 1,
  arrows:false,
  centerMode: true,
  centerPadding:'40px'
});

function select_theme(id) {
    var clicked = 'img/medi/' + id + '_sel.png';
    document.getElementById(id).src = clicked;
    document.getElementById("medi-btn").src = 'img/icon/명상하기_선택후.png';

    $('#medi-btn').on('click', function(){
        if(id==1) {
            var audio = $("audio")[0];

            /*progress bar*/
            var music = document.getElementById('우울');
            var duration = music.duration;

            var playhead = document.getElementById('playhead-1');
            var timeline = document.getElementById('timeline');

            music.addEventListener("timeupdate", timeUpdate, false);

            function timeUpdate() {
	            var playPercent = 100 * (music.currentTime / duration);
	            playhead.style.marginLeft = playPercent + "%";
            }

            music.addEventListener("canplaythrough", function () {
	            duration = music.duration;
            }, false);

                $('#btn-play-pause-1').on('click', function() {
		            if (audio.paused == false) {
			            audio.pause();
			            $(this).children('i').removeClass('fa-pause');
			            $(this).children('i').addClass('fa-play');
                        $(this).css("background-image", "url('img/icon/명상하기_재생.png')");
		            } else {
			            audio.play();
			            $(this).children('i').removeClass('fa-play');
			            $(this).children('i').addClass('fa-pause');
                        $(this).css("background-image", "url('img/icon/명상하기_멈춤.png')");
		            }
	            });

            document.getElementById("medi-home").style.display = "none";
            $('footer').css('display','none');
            document.getElementById("medi-btn").style.display = "none";
            document.getElementById("medi-theme").style.display = "none";
            document.getElementById("medi-1").style.display = "block";
        }
        if(id==2) {

            var audio = $("audio")[1];

            /*progress bar*/
            var music = document.getElementById('집중');
            var duration = music.duration;

            var playhead = document.getElementById('playhead-2');
            var timeline = document.getElementById('timeline');

            music.addEventListener("timeupdate", timeUpdate, false);

            function timeUpdate() {
	            var playPercent = 100 * (music.currentTime / duration);
	            playhead.style.marginLeft = playPercent + "%";
            }

            music.addEventListener("canplaythrough", function () {
	            duration = music.duration;
            }, false);

	            $('#btn-play-pause-2').on('click', function() {
		            if (audio.paused == false) {
			            audio.pause();
			            $(this).children('i').removeClass('fa-pause');
			            $(this).children('i').addClass('fa-play');
                        $(this).css("background-image", "url('img/icon/명상하기_재생.png')");
		            } else {
			            audio.play();
			            $(this).children('i').removeClass('fa-play');
			            $(this).children('i').addClass('fa-pause');
                        $(this).css("background-image", "url('img/icon/명상하기_멈춤.png')");
		            }
	            });

            document.getElementById("medi-home").style.display = "none";
            $('footer').css('display','none');
            document.getElementById("medi-btn").style.display = "none";
            document.getElementById("medi-theme").style.display = "none";
            document.getElementById("medi-2").style.display = "block";
        }
        if(id==3) {
            var audio = $("audio")[2];

            /*progress bar*/
            var music = document.getElementById('푹잠');
            var duration = music.duration;

            var playhead = document.getElementById('playhead-3');
            var timeline = document.getElementById('timeline');

            music.addEventListener("timeupdate", timeUpdate, false);

            function timeUpdate() {
	            var playPercent = 100 * (music.currentTime / duration);
	            playhead.style.marginLeft = playPercent + "%";
            }

            music.addEventListener("canplaythrough", function () {
	            duration = music.duration;
            }, false);

	            $('#btn-play-pause-3').on('click', function() {
		            if (audio.paused == false) {
			            audio.pause();
			            $(this).children('i').removeClass('fa-pause');
			            $(this).children('i').addClass('fa-play');
                        $(this).css("background-image", "url('img/icon/명상하기_재생.png')");
		            } else {
			            audio.play();
			            $(this).children('i').removeClass('fa-play');
			            $(this).children('i').addClass('fa-pause');
                        $(this).css("background-image", "url('img/icon/명상하기_멈춤.png')");
		            }
	            });

            document.getElementById("medi-home").style.display = "none";
            $('footer').css('display','none');
            document.getElementById("medi-btn").style.display = "none";
            document.getElementById("medi-theme").style.display = "none";
            document.getElementById("medi-3").style.display = "block";
        }
        if(id==4) {
            var audio = $("audio")[3];

            /*progress bar*/
            var music = document.getElementById('명상');
            var duration = music.duration;

            var playhead = document.getElementById('playhead-4');
            var timeline = document.getElementById('timeline');

            music.addEventListener("timeupdate", timeUpdate, false);

            function timeUpdate() {
	            var playPercent = 100 * (music.currentTime / duration);
	            playhead.style.marginLeft = playPercent + "%";
            }

            music.addEventListener("canplaythrough", function () {
	            duration = music.duration;
            }, false);

	            $('#btn-play-pause-4').on('click', function() {
		            if (audio.paused == false) {
			            audio.pause();
			            $(this).children('i').removeClass('fa-pause');
			            $(this).children('i').addClass('fa-play');
                        $(this).css("background-image", "url('img/icon/명상하기_재생.png')");
		            } else {
			            audio.play();
			            $(this).children('i').removeClass('fa-play');
			            $(this).children('i').addClass('fa-pause');
                        $(this).css("background-image", "url('img/icon/명상하기_멈춤.png')");
		            }
	            });

            document.getElementById("medi-home").style.display = "none";
            $('footer').css('display','none');
            document.getElementById("medi-btn").style.display = "none";
            document.getElementById("medi-theme").style.display = "none";
            document.getElementById("medi-4").style.display = "block";
        }
    });
}

function medi_end(hasFilter) {
    const popup = document.querySelector('#popup');
  
    if (hasFilter) {
  	    popup.classList.add('has-filter');
    } else {
  	    popup.classList.remove('has-filter');
    }
  
    popup.classList.remove('hide');
}

</script>
</body>